box: ubuntu
build:
  steps:
    - script:
        name: install dotnet core
        code: |
          sh -c 'echo "deb [arch=amd64] https://apt-mo.trafficmanager.net/repos/dotnet-release/ xenial main" > /etc/apt/sources.list.d/dotnetdev.list'
          apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 417A0893
          apt-get update
          apt-get install dotnet-dev-1.0.0-preview2-003131

    - script:
        name: install eventstore
        code: |
          apt-get install wget
          wget http://download.geteventstore.com/binaries/EventStore-OSS-Ubuntu-14.04-v3.9.1.tar.gz
          tar xfv EventStore-OSS-Ubuntu-14.04-v3.9.1.tar.gz
          nohup ./EventStore-OSS-Ubuntu-14.04-v3.9.1/eventstored &

    # Run tests
    - script:
        name: Run tests
        code: |
          dotnet test test/EventStore.ClientAPI.NetCore.Tests/project.json
